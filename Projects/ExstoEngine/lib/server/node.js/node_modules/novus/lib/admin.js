var admin = exports,
    io = require('socket.io'),
    config = require('./config'),
    novus = require('./novus');

admin.bind = function (socket) {
  // Logs the user into the admin interface
  socket.on('admin', function (data) {
    if(data.username == config.admin.username 
        && data.password == config.admin.password
        && config.admin.enabled == true) {
      socket.set('admin', true);
      socket.emit('admin', { success: true });
    } else {
      socket.emit('admin', { success: false });
    }
  });
  
  // Generates and sends statistics
  socket.on('stats', function (data) {
    socket.get('admin', function (err, admin) {
      if(admin == true) {
        var data = {
          users: novus.UserManager.numUsers(),
          rooms: novus.RoomManager.rooms.length
        };
        
        socket.emit('stats', data);
      }
    });
  });
};