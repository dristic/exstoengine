$(document).ready(function () {
  var $login = $('#login'),
      $admin = $('#admin'),
      $username = $('input[name="username"]'),
      $password = $('input[name="password"]'),
      socket = io.connect('##url');
  
  $admin.hide();
  
  socket.on('admin', function (data) {
    if(data.success == true) {
      $login.fadeOut(400, function () {
        $admin.fadeIn(400);
        socket.emit('stats', {});
      });
    } else {
      alert("Wrong");
    }
  });
  
  socket.on('stats', function (data) {
    $('#users').text(data.users);
    $('#rooms').text(data.rooms);
  });
  
  $('#login input[type="submit"]').click(function (event) {
    var data = {
      username: $username.val(),
      password: $password.val()
    };
    
    socket.emit('admin', data);
  });
  
  $('#admin #refresh').click(function (event) {
    socket.emit('stats', {});
  });
  
  setInterval(function () {
    socket.emit('stats', {});
  }, 3000);
});